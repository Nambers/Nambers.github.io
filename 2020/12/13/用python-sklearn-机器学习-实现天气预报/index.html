<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="项目地址github项目:PYWeatherReport 系列教程 本文章为以下几篇的合集机器学习参考篇: python+sklearn+kaggle机器学习用python+sklearn(机器学习)实现天气预报 准备用python+sklearn(机器学习)实现天气预报数据 数据 用python+sklearn(机器学习)实现天气预报 模型和使用  0.流程介绍爬虫爬取去年今日的半个月前到去年今">
<meta property="og:type" content="article">
<meta property="og:title" content="用python+sklearn(机器学习)实现天气预测">
<meta property="og:url" content="https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/index.html">
<meta property="og:site_name" content="Eritque arcus&#39;s blog">
<meta property="og:description" content="项目地址github项目:PYWeatherReport 系列教程 本文章为以下几篇的合集机器学习参考篇: python+sklearn+kaggle机器学习用python+sklearn(机器学习)实现天气预报 准备用python+sklearn(机器学习)实现天气预报数据 数据 用python+sklearn(机器学习)实现天气预报 模型和使用  0.流程介绍爬虫爬取去年今日的半个月前到去年今">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-0.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-1.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-2.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-3.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-4.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-5.png">
<meta property="og:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-6.png">
<meta property="article:published_time" content="2020-12-14T03:30:02.000Z">
<meta property="article:modified_time" content="2024-02-09T23:10:53.494Z">
<meta property="article:author" content="Eritque arcus">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Sklearn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://eritque-arcus.tech/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-0.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/avatar.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/avatar.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.png">
        
      
    
    <!-- title -->
    <title>用python+sklearn(机器学习)实现天气预测</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->

    <script async defer
            data-website-id="03f1081f-d820-47e8-84c9-245f9093244c"
            src="https://4-um4m1.eritque-arcus.tech/script.js">
    </script>


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Eritque arcus&#39;s blog" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.0.0-rc2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Nambers">Projects</a></li><!--
     --><!--
       --><li><a href="/files/">Files</a></li><!--
     --><!--
       --><li><a href="/ctf-cheatsheet/">CTF-cheatsheet</a></li><!--
     --><!--
       --><li><a href="/link/">Links</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html">Travelling</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2020/12/28/Mirai-qq%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%A1%86%E6%9E%B6kotlin_java%E6%95%99%E7%A8%8B/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2020/01/26/%E4%BD%BF%E7%94%A8html+css+js%E5%88%B6%E4%BD%9C%E7%BD%91%E7%AB%99%E6%95%99%E7%A8%8B/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.facebook.com/sharer.php?u=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://twitter.com/share?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&text=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.linkedin.com/shareArticle?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&is_video=false&description=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=用python+sklearn(机器学习)实现天气预测&body=Check out this article: https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/" rel="external nofollow noreferrer"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://getpocket.com/save?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://reddit.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.stumbleupon.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://digg.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.tumblr.com/share/link?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&name=用python+sklearn(机器学习)实现天气预测&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://news.ycombinator.com/submitlink?u=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&t=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80"><span class="toc-number">1.</span> <span class="toc-text">项目地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">系列教程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E6%B5%81%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">0.流程介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">4.</span> <span class="toc-text">1. 环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a-python"><span class="toc-number">5.</span> <span class="toc-text">a.python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E5%BA%93"><span class="toc-number">5.1.</span> <span class="toc-text">1.1 涉及到的机器学习相关库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-sklearn"><span class="toc-number">5.1.1.</span> <span class="toc-text">1.1.1 sklearn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-panda"><span class="toc-number">5.1.2.</span> <span class="toc-text">1.1.2 panda</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-seaborn"><span class="toc-number">5.1.3.</span> <span class="toc-text">1.1.3 seaborn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-joblib"><span class="toc-number">5.1.4.</span> <span class="toc-text">1.1.4 joblib</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%BB%E6%89%BE%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90"><span class="toc-number">6.</span> <span class="toc-text">2.寻找数据来源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E6%BA%90%E7%BD%91%E5%9D%80%E8%A7%84%E5%88%99"><span class="toc-number">7.</span> <span class="toc-text">3.分析数据源网址规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%86%E6%9E%90%E9%A1%B5%E9%9D%A2%E8%A7%84%E5%88%99"><span class="toc-number">8.</span> <span class="toc-text">4.分析页面规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8B%98%E8%AF%AF%E8%A1%A8"><span class="toc-number">9.</span> <span class="toc-text">勘误表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%88%AC%E8%99%AB"><span class="toc-number">10.</span> <span class="toc-text">5.爬虫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1%E7%A1%AE%E8%AE%A4%E8%A6%81%E8%A2%AB%E7%88%AC%E5%8F%96%E7%9A%84%E7%BD%91%E9%A1%B5%E7%BD%91%E5%9D%80"><span class="toc-number">10.1.</span> <span class="toc-text">5.1确认要被爬取的网页网址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%88%AC%E8%99%AB%E9%83%A8%E5%88%86"><span class="toc-number">10.2.</span> <span class="toc-text">5.2 爬虫部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E5%8C%B9%E9%85%8D%E5%8F%96%E5%87%BA%E9%83%A8%E5%88%86"><span class="toc-number">10.3.</span> <span class="toc-text">5.3 网页内容匹配取出部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4%E5%86%99%E5%85%A5csv%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">10.4.</span> <span class="toc-text">5.4写入csv文件格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6%E5%B0%81%E8%A3%85%E6%88%90%E7%B1%BB"><span class="toc-number">10.5.</span> <span class="toc-text">5.6封装成类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text">6.数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%BB%BA%E7%AB%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.</span> <span class="toc-text">7.建立模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1%E5%87%86%E5%A4%87"><span class="toc-number">12.1.</span> <span class="toc-text">7.1准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-1-%E5%BC%95%E5%85%A5%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-number">12.1.1.</span> <span class="toc-text">7.1.1 引入所需要的头文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-%E9%80%89%E6%8B%A9%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.1.2.</span> <span class="toc-text">7.1.2 选择模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-3-%E9%80%89%E6%8B%A9%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95"><span class="toc-number">12.1.3.</span> <span class="toc-text">7.1.3 选择评估方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-4-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">12.1.4.</span> <span class="toc-text">7.1.4 获取数据集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2%E5%BB%BA%E7%AB%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.2.</span> <span class="toc-text">7.2建立模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E8%8E%B7%E5%8F%96%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C"><span class="toc-number">12.3.</span> <span class="toc-text">7.3 获取模型评估结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E7%94%A8joblib%E6%A8%A1%E5%9D%97%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.4.</span> <span class="toc-text">7.4 用joblib模块保存模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E5%B0%81%E8%A3%85"><span class="toc-number">12.5.</span> <span class="toc-text">7.5 封装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%80%BB%E6%8E%A7"><span class="toc-number">13.</span> <span class="toc-text">8 总控</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BB%A3%E7%A0%81"><span class="toc-number">13.1.</span> <span class="toc-text">8.1 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">13.2.</span> <span class="toc-text">8.2 使用方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%9C%80%E5%90%8E%E6%95%88%E6%9E%9C"><span class="toc-number">14.</span> <span class="toc-text">9 最后效果</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        用python+sklearn(机器学习)实现天气预测
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Eritque arcus</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-12-14T03:30:02.000Z" class="dt-published" itemprop="datePublished">2020-12-13</time>
        
        (Updated: <time datetime="2024-02-09T23:10:53.494Z" class="dt-updated" itemprop="dateModified">2024-02-09</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Machine-leaning/">Machine leaning</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Python/" rel="tag">Python</a>, <a class="p-category" href="/tags/Sklearn/" rel="tag">Sklearn</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Nambers/PYWeatherReport">github项目:PYWeatherReport</a></p>
<h2 id="系列教程"><a href="#系列教程" class="headerlink" title="系列教程"></a>系列教程</h2><blockquote>
<p>本文章为以下几篇的合集<br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/109260388">机器学习参考篇: python+sklearn+kaggle机器学习</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/111146467">用python+sklearn(机器学习)实现天气预报 准备</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/111182425">用python+sklearn(机器学习)实现天气预报数据 数据</a><br> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/111238926">用python+sklearn(机器学习)实现天气预报 模型和使用</a></p>
</blockquote>
<h2 id="0-流程介绍"><a href="#0-流程介绍" class="headerlink" title="0.流程介绍"></a>0.流程介绍</h2><p>爬虫爬取<code>去年今日的半个月前到去年今日的下个半个月的每日天气数据</code>做训练集和训练验证集，爬取<code>现在半个月前到现在的每日天气数据</code>做预测数据集 -&gt; 数据预处理 -&gt; 训练模型和预测<br>机器学习过程可参考<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/109260388">上面那篇</a></p>
<h2 id="1-环境搭建"><a href="#1-环境搭建" class="headerlink" title="1. 环境搭建"></a>1. 环境搭建</h2><h2 id="a-python"><a href="#a-python" class="headerlink" title="a.python"></a>a.python</h2><p>如题，要使用python+sklearn做，所以肯定要搭建好python的环境，教程百度有很多，建议用python3.*</p>
<h3 id="1-1-涉及到的机器学习相关库"><a href="#1-1-涉及到的机器学习相关库" class="headerlink" title="1.1 涉及到的机器学习相关库"></a>1.1 涉及到的机器学习相关库</h3><p>安装命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install 库名</span><br></pre></td></tr></table></figure>
<h4 id="1-1-1-sklearn"><a href="#1-1-1-sklearn" class="headerlink" title="1.1.1 sklearn"></a>1.1.1 sklearn</h4><p>本教程运用的机器学习核心库</p>
<h4 id="1-1-2-panda"><a href="#1-1-2-panda" class="headerlink" title="1.1.2 panda"></a>1.1.2 panda</h4><p>读取csv相关</p>
<h4 id="1-1-3-seaborn"><a href="#1-1-3-seaborn" class="headerlink" title="1.1.3 seaborn"></a>1.1.3 seaborn</h4><p>数据可视化，生成图表如折线图等</p>
<h4 id="1-1-4-joblib"><a href="#1-1-4-joblib" class="headerlink" title="1.1.4 joblib"></a>1.1.4 joblib</h4><p>保存和读取训练好的模型，<code>*.pkl</code>文件</p>
<h2 id="2-寻找数据来源"><a href="#2-寻找数据来源" class="headerlink" title="2.寻找数据来源"></a>2.寻找数据来源</h2><p>做机器学习我们需要尽量多和准确的数据，本次实例从<a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.meteomanz.com/">www.meteomanz.com</a>获取免费的天气数据</p>
<h2 id="3-分析数据源网址规则"><a href="#3-分析数据源网址规则" class="headerlink" title="3.分析数据源网址规则"></a>3.分析数据源网址规则</h2><p>我们访问上一步的网站，可以发现有选择城市和时间的接口(PS:右上角的链接可以切换成英文)<br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-0.png" alt="网站"><br>接下来我们选择我们要做天气预报的城市和顺便一个时间点，如广州(PS:在选择框直接输入城市的前几个字符可以快速索引)<br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-1.png" alt="网站"><br>然后点按钮，我们会跳转到一个网页<br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-2.png" alt="网页"><br>这个就是我们要取到的数据了的地址，不过时间不对，接下来解析这个网址的规则，如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287&amp;d1=13&amp;m1=12&amp;y1=2020&amp;d2=13&amp;m2=12&amp;y2=2020</span><br></pre></td></tr></table></figure>
<p>这里面</p>
<ul>
<li><code>?</code>前的分别是<code>http://</code>网络协议,<code>www.meteomanz.com</code>域名，<code>/sy2</code>地址，我们主要关注<code>?</code>后的参数</li>
<li><code>l</code>是语言参数，l&#x3D;1指英语</li>
<li><code>cou</code>和<code>ind</code>是地区和城市代码</li>
<li><code>d1</code>，<code>m1</code>，<code>y1</code>是时间段的开始年月日</li>
<li><code>d2</code>，<code>m2</code>，<code>y2</code>是时间段的结束年月日</li>
</ul>
<p>所以</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287&amp;d1=02&amp;m1=02&amp;y1=2019&amp;d2=13&amp;m2=12&amp;y2=2020</span><br></pre></td></tr></table></figure>
<p>指从2019&#x2F;2&#x2F;2到2020&#x2F;12&#x2F;13的广州的每日天气数据，不要忘记里面月和日是要补0的，但是进去就发现最多给30天的数据，所以我们以后并不会用到怎么多天的数据</p>
<h2 id="4-分析页面规则"><a href="#4-分析页面规则" class="headerlink" title="4.分析页面规则"></a>4.分析页面规则</h2><p>获取到网址规则后，分析页面规则用于爬虫匹配数据，按F12打开开发者工具<br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-3.png" alt="DEV"><br>如图，我们可以发现rbody里面的第二个tr标签里面的每个td里是数据(PS:用右上角的左边第一个小按钮然后点击那些数据)。<br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-4.png" alt="在这里插入图片描述"><br><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-5.png" alt="在这里插入图片描述"></p>
<p>当我们知道了这些规则，接下来就可以写爬虫爬取符合条件的数据集了。</p>
<h2 id="勘误表"><a href="#勘误表" class="headerlink" title="勘误表"></a>勘误表</h2><ol>
<li>感谢”Gbilibili”的提醒，下面url代码生成片段<br> 应从 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爬取数据链接</span></span><br><span class="line">   url = <span class="string">&quot;http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287&amp;d1=&quot;</span> + </span><br><span class="line">   <span class="built_in">str</span>(week_ago.day).zfill(<span class="number">2</span>) + </span><br><span class="line">   <span class="string">&quot;&amp;m1=&quot;</span> + <span class="built_in">str</span>(week_ago.month).zfill(<span class="number">2</span>) + </span><br><span class="line">   <span class="string">&quot;&amp;y1=&quot;</span> + <span class="built_in">str</span>(week_ago.month) + </span><br><span class="line">   <span class="string">&quot;&amp;d2=&quot;</span> + <span class="built_in">str</span>(week_pre.day - years[<span class="number">0</span>]).zfill(<span class="number">2</span>) + </span><br><span class="line">   <span class="string">&quot;&amp;m2=&quot;</span> + <span class="built_in">str</span>(week_pre.month).zfill(<span class="number">2</span>) + </span><br><span class="line">   <span class="string">&quot;&amp;y2=&quot;</span> + <span class="built_in">str</span>(week_pre.year - years[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
 改成 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment"># 爬取数据链接</span></span><br><span class="line">url = <span class="string">&quot;http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287&amp;d1=&quot;</span> + </span><br><span class="line"> <span class="built_in">str</span>(week_ago.day).zfill(<span class="number">2</span>) +</span><br><span class="line"> <span class="string">&quot;&amp;m1=&quot;</span> + <span class="built_in">str</span>( week_ago.month).zfill(<span class="number">2</span>) +</span><br><span class="line"><span class="string">&quot;&amp;y1=&quot;</span> + <span class="built_in">str</span>(week_ago.year - years[<span class="number">0</span>]) +</span><br><span class="line">	<span class="string">&quot;&amp;d2=&quot;</span> + <span class="built_in">str</span>(week_pre.day).zfill(<span class="number">2</span>) +</span><br><span class="line">	<span class="string">&quot;&amp;m2=&quot;</span> + <span class="built_in">str</span>(week_pre.month).zfill(<span class="number">2</span>) +</span><br><span class="line"> <span class="string">&quot;&amp;y2=&quot;</span> + <span class="built_in">str</span>(week_pre.year - years[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></li>
<li>感谢@L-Zzxnn的提醒，代码已添加负温度支持，最新代码请以github上为准</li>
</ol>
<h2 id="5-爬虫"><a href="#5-爬虫" class="headerlink" title="5.爬虫"></a>5.爬虫</h2><p>爬虫这方面可以参考我之前的<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/qq_40832960/article/details/103854145">一篇文章</a></p>
<h3 id="5-1确认要被爬取的网页网址"><a href="#5-1确认要被爬取的网页网址" class="headerlink" title="5.1确认要被爬取的网页网址"></a>5.1确认要被爬取的网页网址</h3><p>首先我们主要要爬取去年今日的半个月前到去年今日，而根据上一篇我们得出的网址规则，我们可以得到(PS:真正的链接里是没有换行的)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287</span><br><span class="line">&amp;d1=去年今日的半个月前的日</span><br><span class="line">&amp;m1=去年今日的半个月前的月份</span><br><span class="line">&amp;y1=去年年份</span><br><span class="line">&amp;d2=今天的日期的日</span><br><span class="line">&amp;m2=今天的日期的月份</span><br><span class="line">&amp;y2=今年年份</span><br></pre></td></tr></table></figure>
<p>而为什么是取去年和时间要半个月呢？因为去年的天气环境相比于前年或者更久之前是和我们现在的天气条件更相似的，可以减少误差，半个月而不是一个星期是因为使用多的数据量可以减少误差，不是一个月而是因为网站的限制，而且在实验中也会增加少量的误差。所以最终取用了去年和半个月的时间。</p>
<p>如果我们是只测今天这一次上面的网址就可以人工填写，但是如果我们要做不用人工填就要用<code>datetime</code>这个python库<br>如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> DT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取现在日期</span></span><br><span class="line">today = DT.datetime.now()</span><br><span class="line"><span class="comment"># 取b[0]天前日期</span></span><br><span class="line">week_ago = (today - DT.timedelta(days=b[<span class="number">0</span>])).date()</span><br><span class="line"> <span class="comment"># b[1]天后</span></span><br><span class="line"> week_pre = (today + DT.timedelta(days=b[<span class="number">1</span>])).date()</span><br></pre></td></tr></table></figure>
<p>我们传入<code>b = [-15 0]</code>，就可以获取上个半月的日期在<code>week_ago</code>里，今天的日期在<code>week_pre</code>里<br>所以，可以用这一行构建需要的网址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爬取数据链接</span></span><br><span class="line">url = <span class="string">&quot;http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=59287&amp;d1=&quot;</span> + </span><br><span class="line"> <span class="built_in">str</span>(week_ago.day).zfill(<span class="number">2</span>) +</span><br><span class="line"> <span class="string">&quot;&amp;m1=&quot;</span> + <span class="built_in">str</span>( week_ago.month).zfill(<span class="number">2</span>) +</span><br><span class="line"><span class="string">&quot;&amp;y1=&quot;</span> + <span class="built_in">str</span>(week_ago.year - years[<span class="number">0</span>]) +</span><br><span class="line">	<span class="string">&quot;&amp;d2=&quot;</span> + <span class="built_in">str</span>(week_pre.day).zfill(<span class="number">2</span>) +</span><br><span class="line">	<span class="string">&quot;&amp;m2=&quot;</span> + <span class="built_in">str</span>(week_pre.month).zfill(<span class="number">2</span>) +</span><br><span class="line"> <span class="string">&quot;&amp;y2=&quot;</span> + <span class="built_in">str</span>(week_pre.year - years[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>其中<code>.zfill(2)</code>是指填充2位，比如如果是1就返回01，如果是12就返回12<br>有了网址，接下来就是爬虫爬取网页然后分析网页元素取出里面的数据</p>
<h3 id="5-2-爬虫部分"><a href="#5-2-爬虫部分" class="headerlink" title="5.2 爬虫部分"></a>5.2 爬虫部分</h3><p>首先先写爬虫部分，这部分很简单，写了个<code>GetData</code> class</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: GetData.py</span></span><br><span class="line"><span class="comment"># 功能: 爬取数据</span></span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GetData</span>:</span><br><span class="line">    url = <span class="string">&quot;&quot;</span></span><br><span class="line">    headers = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, url, header=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param url: 获取的网址</span></span><br><span class="line"><span class="string">        :param header: 请求头，默认已内置</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.url = url</span><br><span class="line">        <span class="keyword">if</span> header == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            self.headers = &#123;</span><br><span class="line">                <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,&#x27;</span></span><br><span class="line">                          <span class="string">&#x27;*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, &#x27;</span></span><br><span class="line">                              <span class="string">&#x27;like Gecko) Chrome/87.0.4280.66 Mobile Safari/537.36 &#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;www.meteomanz.com&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.headers = header</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :return: 网址对应的网页内容</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        http = urllib3.PoolManager()</span><br><span class="line">        <span class="keyword">return</span> http.request(<span class="string">&#x27;GET&#x27;</span>, self.url, headers=self.headers).data</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>本处用了urllib3库和GET方式，其中headers是申请头，这部分可以在按F12调出开发者工具，在Network那一栏，点击任意一个事件，往下滑就有了，可以用我的也可以。请求头主要是http协议里的东西，想要了解可以自行搜索。</p>
<h3 id="5-3-网页内容匹配取出部分"><a href="#5-3-网页内容匹配取出部分" class="headerlink" title="5.3 网页内容匹配取出部分"></a>5.3 网页内容匹配取出部分</h3><p>本处使用了<code>BeautifulSoup</code>库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">g = GetData(url).Get()</span><br><span class="line">      <span class="comment"># beautifulsoup解析网页</span></span><br><span class="line">      soup = BeautifulSoup(g, <span class="string">&quot;html5lib&quot;</span>)</span><br><span class="line">      <span class="comment"># 取&lt;tbody&gt;内容</span></span><br><span class="line">      tb = soup.find(name=<span class="string">&quot;tbody&quot;</span>)</span><br><span class="line">      <span class="comment"># 取tr内容</span></span><br><span class="line">      past_tr = tb.find_all(name=<span class="string">&quot;tr&quot;</span>)</span><br><span class="line">      <span class="keyword">for</span> tr <span class="keyword">in</span> past_tr:</span><br><span class="line">          <span class="comment"># 取tr内每个td的内容</span></span><br><span class="line">          text = tr.find_all(name=<span class="string">&quot;td&quot;</span>)</span><br><span class="line">          flag = <span class="literal">False</span></span><br><span class="line">          <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text)):</span><br><span class="line">              <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                  text[i] = text[i].a.string</span><br><span class="line">                  <span class="comment"># 网站bug，跨月请求的话会给每个月第0天的数据，但是里面是全空的因为日期不存在，比如 00/11/2020(日/月/年),所以要手动drop掉这个数据</span></span><br><span class="line">                  <span class="keyword">if</span> <span class="string">&quot;00/&quot;</span> <span class="keyword">in</span> text[i]:</span><br><span class="line">                      flag = <span class="literal">True</span></span><br><span class="line">              <span class="keyword">elif</span> i == <span class="number">8</span>:</span><br><span class="line">                  <span class="comment"># 把/8去掉，网页显示的格式问题</span></span><br><span class="line">                  text[i] = text[i].string.replace(<span class="string">&quot;/8&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">              <span class="keyword">elif</span> i == <span class="number">5</span>:</span><br><span class="line">                  <span class="comment"># 去掉Hpa单位</span></span><br><span class="line">                  text[i] = text[i].string.replace(<span class="string">&quot; Hpa&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">              <span class="keyword">elif</span> i == <span class="number">6</span>:</span><br><span class="line">                  <span class="comment"># 用正则去掉风力里括号内的内容</span></span><br><span class="line">                  text[i] = re.sub(<span class="string">u&quot;[º(.*?|N|W|E|S)]&quot;</span>, <span class="string">&quot;&quot;</span>, text[i].string)</span><br><span class="line">              <span class="keyword">else</span>:</span><br><span class="line">                  <span class="comment"># 取每个元素的内容</span></span><br><span class="line">                  text[i] = text[i].string</span><br><span class="line">              <span class="comment"># 丢失数据都取2(简陋做法)</span></span><br><span class="line">              <span class="comment"># 这么做 MAE=3.6021</span></span><br><span class="line">              text[i] = text[i].replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">              text[i] = text[i].replace(<span class="string">&quot;Tr&quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>如果有什么不清楚的评论里答复。</p>
<h3 id="5-4写入csv文件格式化"><a href="#5-4写入csv文件格式化" class="headerlink" title="5.4写入csv文件格式化"></a>5.4写入csv文件格式化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">   <span class="comment"># 创建文件对象</span></span><br><span class="line">   f = <span class="built_in">open</span>(c, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 基于文件对象构建 csv写入对象</span></span><br><span class="line">   csv_writer = csv.writer(f)</span><br><span class="line">   <span class="comment"># 写入内容,text数组</span></span><br><span class="line">	csv_writer.writerow(text)</span><br><span class="line">   <span class="comment"># 关闭文件</span></span><br><span class="line">   f.close()</span><br></pre></td></tr></table></figure>
<h3 id="5-6封装成类"><a href="#5-6封装成类" class="headerlink" title="5.6封装成类"></a>5.6封装成类</h3><p><code>Write.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: Write.py</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">from</span> GetData <span class="keyword">import</span> GetData</span><br><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> DT</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a</span>(<span class="params">t</span>):</span><br><span class="line">    <span class="keyword">return</span> t.replace(<span class="string">&quot; - &quot;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能: 写csv</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">years, b, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param years: [开始日期距离现在的年份, 结束日期距离现在的年份]</span></span><br><span class="line"><span class="string">    :param b: [开始日期距离现在日期的天数, 结束日期距离现在日期的天数]</span></span><br><span class="line"><span class="string">    :param c: csv文件名</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. 创建文件对象</span></span><br><span class="line">    f = <span class="built_in">open</span>(c, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 基于文件对象构建 csv写入对象</span></span><br><span class="line">    csv_writer = csv.writer(f)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 构建列表头</span></span><br><span class="line">    <span class="comment"># , &quot;negAve&quot;, &quot;negMax&quot;, &quot;negMin&quot;</span></span><br><span class="line">    csv_writer.writerow([<span class="string">&quot;Time&quot;</span>, <span class="string">&quot;Ave_t&quot;</span>, <span class="string">&quot;Max_t&quot;</span>, <span class="string">&quot;Min_t&quot;</span>, <span class="string">&quot;Prec&quot;</span>, <span class="string">&quot;SLpress&quot;</span>, <span class="string">&quot;Winddir&quot;</span>, <span class="string">&quot;Windsp&quot;</span>, <span class="string">&quot;Cloud&quot;</span>])</span><br><span class="line">    <span class="comment"># 取现在日期</span></span><br><span class="line">    today = DT.datetime.now()</span><br><span class="line">    <span class="comment"># 取20天前日期</span></span><br><span class="line">    week_ago = (today - DT.timedelta(days=b[<span class="number">0</span>])).date()</span><br><span class="line">    <span class="comment"># 20天后</span></span><br><span class="line">    week_pre = (today + DT.timedelta(days=b[<span class="number">1</span>])).date()</span><br><span class="line">    <span class="comment"># 城市id 广州59287 青岛 54857</span></span><br><span class="line">    <span class="built_in">id</span> = <span class="string">&quot;59287&quot;</span></span><br><span class="line">    <span class="comment"># 爬取数据链接</span></span><br><span class="line">    url = <span class="string">&quot;http://www.meteomanz.com/sy2?l=1&amp;cou=2250&amp;ind=&quot;</span> + <span class="built_in">id</span> + <span class="string">&quot;&amp;d1=&quot;</span> + <span class="built_in">str</span>(week_ago.day).zfill(<span class="number">2</span>) + <span class="string">&quot;&amp;m1=&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">        week_ago.month).zfill(<span class="number">2</span>) + <span class="string">&quot;&amp;y1=&quot;</span> + <span class="built_in">str</span>(week_ago.year - years[<span class="number">0</span>]) + <span class="string">&quot;&amp;d2=&quot;</span> + <span class="built_in">str</span>(week_pre.day).zfill(</span><br><span class="line">        <span class="number">2</span>) + <span class="string">&quot;&amp;m2=&quot;</span> + <span class="built_in">str</span>(week_pre.month).zfill(<span class="number">2</span>) + <span class="string">&quot;&amp;y2=&quot;</span> + <span class="built_in">str</span>(week_pre.year - years[<span class="number">1</span>])</span><br><span class="line">    <span class="comment"># 显示获取数据集的网址</span></span><br><span class="line">    <span class="built_in">print</span>(url)</span><br><span class="line">    g = GetData(url).Get()</span><br><span class="line">    <span class="comment"># beautifulsoup解析网页</span></span><br><span class="line">    soup = BeautifulSoup(g, <span class="string">&quot;html5lib&quot;</span>)</span><br><span class="line">    <span class="comment"># 取&lt;tbody&gt;内容</span></span><br><span class="line">    tb = soup.find(name=<span class="string">&quot;tbody&quot;</span>)</span><br><span class="line">    <span class="comment"># 取tr内容</span></span><br><span class="line">    past_tr = tb.find_all(name=<span class="string">&quot;tr&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> past_tr:</span><br><span class="line">        <span class="comment"># 取tr内每个td的内容</span></span><br><span class="line">        text = tr.find_all(name=<span class="string">&quot;td&quot;</span>)</span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">        negA = negMax = negMin = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text)):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                text[i] = text[i].a.string</span><br><span class="line">                <span class="comment"># 网站bug，会给每个月第0天，比如 00/11/2020,所以要drop掉</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;00/&quot;</span> <span class="keyword">in</span> text[i]:</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">8</span>:</span><br><span class="line">                <span class="comment"># 把/8去掉，网页显示的格式</span></span><br><span class="line">                text[i] = text[i].string.replace(<span class="string">&quot;/8&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">5</span>:</span><br><span class="line">                <span class="comment"># 去掉单位</span></span><br><span class="line">                text[i] = text[i].string.replace(<span class="string">&quot; Hpa&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">6</span>:</span><br><span class="line">                <span class="comment"># 去掉风力里括号内的内容</span></span><br><span class="line">                text[i] = re.sub(<span class="string">u&quot;[º(.*?|N|W|E|S)]&quot;</span>, <span class="string">&quot;&quot;</span>, text[i].string)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 取每个元素的内容</span></span><br><span class="line">                text[i] = text[i].string</span><br><span class="line">            <span class="comment"># 丢失数据都取2(简陋做法)</span></span><br><span class="line">            <span class="comment"># 这么做 MAE=3.6021</span></span><br><span class="line">            text[i] = <span class="string">&quot;2&quot;</span> <span class="keyword">if</span> text[i] == <span class="string">&quot;-&quot;</span> <span class="keyword">else</span> text[i]</span><br><span class="line">            text[i] = <span class="string">&quot;2&quot;</span> <span class="keyword">if</span> text[i] == <span class="string">&quot;Tr&quot;</span> <span class="keyword">else</span> text[i]</span><br><span class="line">        text = text[<span class="number">0</span>:<span class="number">9</span>]</span><br><span class="line">        <span class="comment"># ext += [str(int(negA)), str(int(negMax)), str(int(negMin))]</span></span><br><span class="line">        <span class="comment"># 4. 写入csv文件内容</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">            csv_writer.writerow(text)</span><br><span class="line">    <span class="comment"># 5. 关闭文件</span></span><br><span class="line">    f.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>GetData.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: GetData.py</span></span><br><span class="line"><span class="comment"># 功能: 爬取数据</span></span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GetData</span>:</span><br><span class="line">    url = <span class="string">&quot;&quot;</span></span><br><span class="line">    headers = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, url, header=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :param url: 获取的网址</span></span><br><span class="line"><span class="string">        :param header: 请求头，默认已内置</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        self.url = url</span><br><span class="line">        <span class="keyword">if</span> header == <span class="string">&quot;&quot;</span>:</span><br><span class="line">            self.headers = &#123;</span><br><span class="line">                <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,&#x27;</span></span><br><span class="line">                          <span class="string">&#x27;*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, &#x27;</span></span><br><span class="line">                              <span class="string">&#x27;like Gecko) Chrome/87.0.4280.66 Mobile Safari/537.36 &#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;www.meteomanz.com&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.headers = header</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Get</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :return: 网址对应的网页内容</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        http = urllib3.PoolManager()</span><br><span class="line">        <span class="keyword">return</span> http.request(<span class="string">&#x27;GET&#x27;</span>, self.url, headers=self.headers).data</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>到时候就可以直接用一行命令取得天气数据了，如下面是取去年今日的20天到去年今日的天气数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用近几年的数据做训练集</span></span><br><span class="line">   <span class="comment"># 如 [1,1], [20, 0]就是用2019年的今天的20天前到2019年的今天数据做训练集</span></span><br><span class="line">   <span class="comment"># 写入csv</span></span><br><span class="line">   Write([<span class="number">1</span>, <span class="number">1</span>], [<span class="number">20</span>, <span class="number">0</span>], <span class="string">&quot;weather_train_train.csv&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>结果如下<br><code>weather_train_train.csv</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Time,Ave_t,Max_t,Min_t,Prec,SLpress,Winddir,Windsp,Cloud</span><br><span class="line"></span><br><span class="line">07/12/2019,14.8,20.8,8.8,0.0,1026.3,331,11,0</span><br><span class="line">06/12/2019,15.2,19.8,10.7,0.0,1026.6,344,15,0</span><br><span class="line">05/12/2019,14.5,20.4,8.6,2,1026.2,346,13,8</span><br><span class="line">04/12/2019,13.8,20.4,7.1,0.0,1024.7,335,16,2</span><br><span class="line">03/12/2019,13.0,18.9,7.1,0.0,1024.8,330,10,0</span><br><span class="line">02/12/2019,18.2,24.9,11.5,0.0,1024.8,347,18,3</span><br><span class="line">01/12/2019,18.1,24.9,11.4,0.0,1020.9,332,16,1</span><br><span class="line">30/11/2019,17.5,23.6,11.4,0.0,1020.5,352,8,3</span><br><span class="line">29/11/2019,15.8,20.1,11.5,0.0,1023.6,349,11,4</span><br><span class="line">28/11/2019,20.4,27.1,13.8,0.0,1024.5,337,19,3</span><br><span class="line">27/11/2019,21.9,27.1,16.6,0.0,1021.3,336,12,0</span><br><span class="line">26/11/2019,22.2,28.4,16.1,0.0,1021.1,356,6,6</span><br><span class="line">25/11/2019,22.2,29.3,15.2,0.0,1020.8,344,13,3</span><br><span class="line">24/11/2019,21.4,29.3,13.6,0.0,1018.5,346,5,0</span><br><span class="line">23/11/2019,20.7,28.4,13.0,0.0,1017.2,352,5,1</span><br><span class="line">22/11/2019,19.6,27.6,11.6,0.0,1017.3,331,6,0</span><br><span class="line">21/11/2019,18.4,25.1,11.6,0.0,1019.1,323,9,1</span><br><span class="line">20/11/2019,18.3,24.2,12.4,0.0,1020.3,338,7,0</span><br><span class="line">19/11/2019,19.1,25.4,12.8,0.0,1020.5,342,11,0</span><br><span class="line">18/11/2019,22.2,28.8,15.7,0.0,1018.8,342,17,0</span><br><span class="line">17/11/2019,22.2,28.8,15.7,0.0,1015.2,358,7,3</span><br></pre></td></tr></table></figure>
<h2 id="6-数据预处理"><a href="#6-数据预处理" class="headerlink" title="6.数据预处理"></a>6.数据预处理</h2><p>如果在把上面的数据作为数据集训练，我们还需要做些数据的预处理，因为有些情况下我们得到的数据会有残缺，这种情况我们就要选择抛弃那一列或者用方差或其他什么的方法填充缺少的数据。</p>
<p>因为在我已经决定把数据里丢失的项全部取2了，所以下面我会列出可能的解决方法而不使用。</p>
<p>新建个<code>ProcessData.py</code>里建立<code>ProcessData</code>方法以获得数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: ProcessData.py</span></span><br><span class="line"><span class="keyword">from</span> Write <span class="keyword">import</span> Write</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.impute <span class="keyword">import</span> SimpleImputer</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能: 数据预处理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ProcessData</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">        [X_train X训练数据集,</span></span><br><span class="line"><span class="string">        X_valid X训练数据集的验证集,</span></span><br><span class="line"><span class="string">        y_train Y训练数据集,</span></span><br><span class="line"><span class="string">        y_valid Y训练数据集的验证集,</span></span><br><span class="line"><span class="string">        imputed_X_test 预测数据集]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 用近几年的数据做训练集</span></span><br><span class="line">    <span class="comment"># 如 [1,1], [20, 0]就是用2019年的今天的20天前到2019年的今天数据做训练集</span></span><br><span class="line">    <span class="comment"># 写入csv</span></span><br><span class="line">    Write([<span class="number">1</span>, <span class="number">1</span>], [<span class="number">20</span>, <span class="number">0</span>], <span class="string">&quot;weather_train_train.csv&quot;</span>)</span><br><span class="line">    Write([<span class="number">1</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">20</span>], <span class="string">&quot;weather_train_valid.csv&quot;</span>)</span><br><span class="line">    Write([<span class="number">0</span>, <span class="number">0</span>], [<span class="number">20</span>, <span class="number">0</span>], <span class="string">&quot;weather_test.csv&quot;</span>)</span><br><span class="line">    X_test = pd.read_csv(<span class="string">&quot;weather_test.csv&quot;</span>, index_col=<span class="string">&quot;Time&quot;</span>, parse_dates=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 读取测试集和验证集</span></span><br><span class="line">    X = pd.read_csv(<span class="string">&quot;weather_train_train.csv&quot;</span>, index_col=<span class="string">&quot;Time&quot;</span>, parse_dates=<span class="literal">True</span>)</span><br><span class="line">    y = pd.read_csv(<span class="string">&quot;weather_train_valid.csv&quot;</span>, index_col=<span class="string">&quot;Time&quot;</span>, parse_dates=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 把全部丢失的数据都drop，MAE=3.7又高了，所以去掉了</span></span><br><span class="line">    <span class="comment"># dxtcol = [col for col in X_test.columns</span></span><br><span class="line">    <span class="comment">#           if X_test[col].isnull().all()]</span></span><br><span class="line">    <span class="comment"># dxcol = [col for col in X.columns</span></span><br><span class="line">    <span class="comment">#          if X[col].isnull().all()]</span></span><br><span class="line">    <span class="comment"># dycol = [col for col in y.columns</span></span><br><span class="line">    <span class="comment">#          if y[col].isnull().all()]</span></span><br><span class="line">    <span class="comment"># for a1 in [dxtcol, dxcol, dycol]:</span></span><br><span class="line">    <span class="comment">#     for a2 in a1:</span></span><br><span class="line">    <span class="comment">#         if a2 in X_test.columns:</span></span><br><span class="line">    <span class="comment">#             X_test = X_test.drop(a2, axis=1)</span></span><br><span class="line">    <span class="comment">#         if a2 in X.columns:</span></span><br><span class="line">    <span class="comment">#             X = X.drop(a2, axis=1)</span></span><br><span class="line">    <span class="comment">#         if a2 in y.columns:</span></span><br><span class="line">    <span class="comment">#             y = y.drop(a2, axis=1)</span></span><br><span class="line">    <span class="comment"># 数据归一化和标准化，无法还原不用</span></span><br><span class="line">    <span class="comment"># scaler = preprocessing.StandardScaler()</span></span><br><span class="line">    <span class="comment"># pars = [cols for cols in X.columns if cols != &quot;Time&quot;]</span></span><br><span class="line">    <span class="comment"># for data in [X, y, X_test]:</span></span><br><span class="line">    <span class="comment">#     for par in pars:</span></span><br><span class="line">    <span class="comment">#         data[par] = scaler.fit_transform(data[par].values.reshape(-1, 1))</span></span><br><span class="line">    <span class="comment">#         # temp = scaler.fit(data[par].values.reshape(-1, 1))</span></span><br><span class="line">    <span class="comment">#         # data[par] = scaler.fit_transform(data[par].values.reshape(-1, 1), temp)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 填充缺少的数值用方差，不清楚效果如何</span></span><br><span class="line">    my_imputer = SimpleImputer()</span><br><span class="line">    X_train, X_valid, y_train, y_valid = train_test_split(X, y, train_size=<span class="number">0.8</span>, test_size=<span class="number">0.2</span>, random_state=<span class="number">0</span>)</span><br><span class="line">    imputed_X_train = pd.DataFrame(my_imputer.fit_transform(X_train))</span><br><span class="line">    imputed_X_valid = pd.DataFrame(my_imputer.transform(X_valid))</span><br><span class="line">    imputed_X_train.columns = X_train.columns</span><br><span class="line">    imputed_X_valid.columns = X_valid.columns</span><br><span class="line">    imputed_y_train = pd.DataFrame(my_imputer.fit_transform(y_train))</span><br><span class="line">    imputed_y_valid = pd.DataFrame(my_imputer.transform(y_valid))</span><br><span class="line">    imputed_y_train.columns = y_train.columns</span><br><span class="line">    imputed_y_valid.columns = y_valid.columns</span><br><span class="line">    imputed_X_test = pd.DataFrame(my_imputer.fit_transform(X_test))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 画折线图</span></span><br><span class="line">    <span class="comment"># sns.lineplot(data=X)</span></span><br><span class="line">    <span class="comment"># plt.show()</span></span><br><span class="line">    <span class="comment"># sns.lineplot(data=y)</span></span><br><span class="line">    <span class="comment"># plt.show()</span></span><br><span class="line">    <span class="comment"># sns.lineplot(data=X_test)</span></span><br><span class="line">    <span class="comment"># plt.show()</span></span><br><span class="line">    <span class="comment"># 返回分割后的数据集</span></span><br><span class="line">    <span class="keyword">return</span> [imputed_X_train, imputed_X_valid, imputed_y_train, imputed_y_valid, imputed_X_test]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="7-建立模型"><a href="#7-建立模型" class="headerlink" title="7.建立模型"></a>7.建立模型</h2><h3 id="7-1准备"><a href="#7-1准备" class="headerlink" title="7.1准备"></a>7.1准备</h3><h4 id="7-1-1-引入所需要的头文件"><a href="#7-1-1-引入所需要的头文件" class="headerlink" title="7.1.1 引入所需要的头文件"></a>7.1.1 引入所需要的头文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor <span class="comment"># 随机树森林模型</span></span><br><span class="line"><span class="keyword">import</span> joblib <span class="comment"># 保存模型为pkl</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error <span class="comment"># MAE评估方法</span></span><br><span class="line"><span class="keyword">from</span> ProcessData <span class="keyword">import</span> ProcessData <span class="comment"># 取数据</span></span><br></pre></td></tr></table></figure>
<h4 id="7-1-2-选择模型"><a href="#7-1-2-选择模型" class="headerlink" title="7.1.2 选择模型"></a>7.1.2 选择模型</h4><p>首先我们先要从模型里选择一项适合这次场景的模型，比如从决策树，随机树森林，RGB模型等等中选择，本处选用的随机树森林也就是RandomForest</p>
<h4 id="7-1-3-选择评估方法"><a href="#7-1-3-选择评估方法" class="headerlink" title="7.1.3 选择评估方法"></a>7.1.3 选择评估方法</h4><p>目前有许多的模型准确率评估方法，本处使用的是MAE，也就是mean_absolute_error 平均错误数值，就每个预测的数值离正确数值错误数值的平均数</p>
<h4 id="7-1-4-获取数据集"><a href="#7-1-4-获取数据集" class="headerlink" title="7.1.4 获取数据集"></a>7.1.4 获取数据集</h4><p>这次可以从<code>ProcessData()</code>获取到全部的被预处理后的数据，如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取到数据</span></span><br><span class="line">    [X_train, X_valid, y_train, y_valid, X_test] = ProcessData()</span><br></pre></td></tr></table></figure>
<h3 id="7-2建立模型"><a href="#7-2建立模型" class="headerlink" title="7.2建立模型"></a>7.2建立模型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用XGB模型，不过用有bug</span></span><br><span class="line">   <span class="comment"># modelX = XGBRegressor(n_estimators=1000, learning_rate=0.05, random_state=0, n_jobs=4)</span></span><br><span class="line">   <span class="comment"># # model.fit(X_train_3, y_train_3)</span></span><br><span class="line">   <span class="comment"># # model.fit(X_train_2, y_train_2)</span></span><br><span class="line">   <span class="comment"># col = [&quot;Ave_t&quot;, &quot;Max_t&quot;, &quot;Min_t&quot;, &quot;Prec&quot;,&quot;SLpress&quot;, &quot;Winddir&quot;, &quot;Windsp&quot;, &quot;Cloud&quot;]</span></span><br><span class="line">   <span class="comment"># modelX.fit(X_train, y_train,</span></span><br><span class="line">   <span class="comment">#           early_stopping_rounds=5,</span></span><br><span class="line">   <span class="comment">#           eval_set=[(X_valid, y_valid)],</span></span><br><span class="line">   <span class="comment">#           verbose=False)</span></span><br><span class="line">   <span class="comment"># 随机树森林模型</span></span><br><span class="line">   model = RandomForestRegressor(random_state=<span class="number">0</span>, n_estimators=<span class="number">1001</span>)</span><br><span class="line">   <span class="comment"># 训练模型</span></span><br><span class="line">   model.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>
<p>其中n_estimators是可自己选的，不过在多次调试后得到1001是MAE最优</p>
<h3 id="7-3-获取模型评估结果"><a href="#7-3-获取模型评估结果" class="headerlink" title="7.3 获取模型评估结果"></a>7.3 获取模型评估结果</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用MAE评估</span></span><br><span class="line">   score = mean_absolute_error(y_valid, preds)</span><br></pre></td></tr></table></figure>
<h3 id="7-4-用joblib模块保存模型"><a href="#7-4-用joblib模块保存模型" class="headerlink" title="7.4 用joblib模块保存模型"></a>7.4 用joblib模块保存模型</h3><p>保存后的模型便于传播即可多次使用，但当前环境下的需求不大但我还是写了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保存模型到本地</span></span><br><span class="line">joblib.dump(model, a)</span><br></pre></td></tr></table></figure>
<h3 id="7-5-封装"><a href="#7-5-封装" class="headerlink" title="7.5 封装"></a>7.5 封装</h3><p><code>GetModel.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: GetModel.py</span></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line"><span class="keyword">from</span> ProcessData <span class="keyword">import</span> ProcessData</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练并保存模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetModel</span>(<span class="params">a=<span class="string">&quot;Model.pkl&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param a: 模型文件名</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">        [socre: MAE评估结果,</span></span><br><span class="line"><span class="string">        X_test: 预测数据集]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 取到数据</span></span><br><span class="line">    [X_train, X_valid, y_train, y_valid, X_test] = ProcessData()</span><br><span class="line">    <span class="comment"># 用XGB模型，不过用有bug</span></span><br><span class="line">    <span class="comment"># modelX = XGBRegressor(n_estimators=1000, learning_rate=0.05, random_state=0, n_jobs=4)</span></span><br><span class="line">    <span class="comment"># # model.fit(X_train_3, y_train_3)</span></span><br><span class="line">    <span class="comment"># # model.fit(X_train_2, y_train_2)</span></span><br><span class="line">    <span class="comment"># col = [&quot;Ave_t&quot;, &quot;Max_t&quot;, &quot;Min_t&quot;, &quot;Prec&quot;,&quot;SLpress&quot;, &quot;Winddir&quot;, &quot;Windsp&quot;, &quot;Cloud&quot;]</span></span><br><span class="line">    <span class="comment"># modelX.fit(X_train, y_train,</span></span><br><span class="line">    <span class="comment">#           early_stopping_rounds=5,</span></span><br><span class="line">    <span class="comment">#           eval_set=[(X_valid, y_valid)],</span></span><br><span class="line">    <span class="comment">#           verbose=False)</span></span><br><span class="line">    <span class="comment"># 随机树森林模型</span></span><br><span class="line">    model = RandomForestRegressor(random_state=<span class="number">0</span>, n_estimators=<span class="number">1001</span>)</span><br><span class="line">    <span class="comment"># 训练模型</span></span><br><span class="line">    model.fit(X_train, y_train)</span><br><span class="line">    <span class="comment"># 预测模型，用上个星期的数据</span></span><br><span class="line">    preds = model.predict(X_valid)</span><br><span class="line">    <span class="comment"># 用MAE评估</span></span><br><span class="line">    score = mean_absolute_error(y_valid, preds)</span><br><span class="line">    <span class="comment"># 保存模型到本地</span></span><br><span class="line">    joblib.dump(model, a)</span><br><span class="line">    <span class="comment"># 返回MAE</span></span><br><span class="line">    <span class="keyword">return</span> [score, X_test]</span><br></pre></td></tr></table></figure>
<h2 id="8-总控"><a href="#8-总控" class="headerlink" title="8 总控"></a>8 总控</h2><h3 id="8-1-代码"><a href="#8-1-代码" class="headerlink" title="8.1 代码"></a>8.1 代码</h3><p>这几篇文章写了零零散散好几个类，所以要写个总文件也就是启动文件串起来，然后在控制台输出<br><code>Main.py</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time: 2020/12/16</span></span><br><span class="line"><span class="comment"># @Author: Eritque arcus</span></span><br><span class="line"><span class="comment"># @File: Main.py</span></span><br><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> DT</span><br><span class="line"><span class="keyword">from</span> GetModel <span class="keyword">import</span> GetModel</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练并保存模型并返回MAE</span></span><br><span class="line">r = GetModel()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;MAE:&quot;</span>, r[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># 读取保存的模型</span></span><br><span class="line">model = joblib.load(<span class="string">&#x27;Model.pkl&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终预测结果</span></span><br><span class="line">preds = model.predict(r[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 反归一化或标准化，不过出bug了，不用</span></span><br><span class="line"><span class="comment"># for cols in range(0, len(preds)):</span></span><br><span class="line"><span class="comment">#     preds[cols] = scaler.inverse_transform(preds[cols])</span></span><br><span class="line"><span class="comment"># sns.lineplot(data=preds)</span></span><br><span class="line"><span class="comment"># plt.show()</span></span><br><span class="line"><span class="comment"># 打印结果到控制台</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未来7天预测&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(preds)</span><br><span class="line">all_ave_t = []</span><br><span class="line">all_high_t = []</span><br><span class="line">all_low_t = []</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">    today = DT.datetime.now()</span><br><span class="line">    time = (today + DT.timedelta(days=a)).date()</span><br><span class="line">    <span class="built_in">print</span>(time.year, <span class="string">&#x27;/&#x27;</span>, time.month, <span class="string">&#x27;/&#x27;</span>, time.day,</span><br><span class="line">          <span class="string">&#x27;: 平均气温&#x27;</span>,  preds[a][<span class="number">0</span>],</span><br><span class="line">          <span class="string">&#x27;最高气温&#x27;</span>, preds[a][<span class="number">1</span>],</span><br><span class="line">          <span class="string">&#x27;最低气温&#x27;</span>, preds[a][<span class="number">2</span>],</span><br><span class="line">          <span class="string">&quot;降雨量&quot;</span>, preds[a][<span class="number">3</span>],</span><br><span class="line">          <span class="string">&quot;风力&quot;</span>, preds[a][<span class="number">4</span>])</span><br><span class="line">    all_ave_t.append(preds[a][<span class="number">0</span>])</span><br><span class="line">    all_high_t.append(preds[a][<span class="number">1</span>])</span><br><span class="line">    all_low_t.append(preds[a][<span class="number">2</span>])</span><br><span class="line">temp = &#123;<span class="string">&quot;ave_t&quot;</span>: all_ave_t, <span class="string">&quot;high_t&quot;</span>: all_high_t, <span class="string">&quot;low_t&quot;</span>: all_low_t&#125;</span><br><span class="line"><span class="comment"># 绘画折线图</span></span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>), temp[<span class="string">&quot;ave_t&quot;</span>], color=<span class="string">&quot;green&quot;</span>, label=<span class="string">&quot;ave_t&quot;</span>)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>), temp[<span class="string">&quot;high_t&quot;</span>], color=<span class="string">&quot;red&quot;</span>, label=<span class="string">&quot;high_t&quot;</span>)</span><br><span class="line">plt.plot(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>), temp[<span class="string">&quot;low_t&quot;</span>], color=<span class="string">&quot;blue&quot;</span>, label=<span class="string">&quot;low_t&quot;</span>)</span><br><span class="line">plt.legend()  <span class="comment"># 显示图例</span></span><br><span class="line">plt.ylabel(<span class="string">&quot;Temperature(°C)&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;day&quot;</span>)</span><br><span class="line"><span class="comment"># 显示</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="8-2-使用方法"><a href="#8-2-使用方法" class="headerlink" title="8.2 使用方法"></a>8.2 使用方法</h3><p>直接用python运行pre_weather&#x2F;Main.py，就会在控制台输出预测的数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pre_weather/Main.py</span><br></pre></td></tr></table></figure>
<p>或</p>
<p>在你的python代码里用joblib导入生成的模型，然后输入你的数据进行预测</p>
<p>(PS: 因为模型的训练用的数据日期和你预测数据的日期有关，所以不建议直接用使用非当天训练的模型进行预测，误差可能偏大)</p>
<p>如以下代码(在Main.py的11行):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> joblib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取保存的模型</span></span><br><span class="line">model = joblib.load(<span class="string">&#x27;Model.pkl&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终预测结果</span></span><br><span class="line">preds = model.predict(r[<span class="number">1</span>])</span><br><span class="line">其中，r[<span class="number">1</span>]是预测数据</span><br></pre></td></tr></table></figure>
<p>或</p>
<p>参考<code>Main.py</code>，自己写一个符合你需求的启动文件</p>
<h2 id="9-最后效果"><a href="#9-最后效果" class="headerlink" title="9 最后效果"></a>9 最后效果</h2><p><img src="/images/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5.md-6.png" alt="效果"></p>
<blockquote>
<p>本系列教程到这就结束了，代码具体还要以<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Nambers/PYWeatherReport">github项目:PYWeatherReport</a>为主，可能会在这个github项目上不定期优化更新</p>
</blockquote>
<center>-END-</center>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Nambers">Projects</a></li>
        
          <li><a href="/files/">Files</a></li>
        
          <li><a href="/ctf-cheatsheet/">CTF-cheatsheet</a></li>
        
          <li><a href="/link/">Links</a></li>
        
          <li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html">Travelling</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80"><span class="toc-number">1.</span> <span class="toc-text">项目地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">系列教程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E6%B5%81%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text">0.流程介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">4.</span> <span class="toc-text">1. 环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a-python"><span class="toc-number">5.</span> <span class="toc-text">a.python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%B6%89%E5%8F%8A%E5%88%B0%E7%9A%84%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E5%BA%93"><span class="toc-number">5.1.</span> <span class="toc-text">1.1 涉及到的机器学习相关库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-sklearn"><span class="toc-number">5.1.1.</span> <span class="toc-text">1.1.1 sklearn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-panda"><span class="toc-number">5.1.2.</span> <span class="toc-text">1.1.2 panda</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-seaborn"><span class="toc-number">5.1.3.</span> <span class="toc-text">1.1.3 seaborn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-joblib"><span class="toc-number">5.1.4.</span> <span class="toc-text">1.1.4 joblib</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%BB%E6%89%BE%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90"><span class="toc-number">6.</span> <span class="toc-text">2.寻找数据来源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%88%86%E6%9E%90%E6%95%B0%E6%8D%AE%E6%BA%90%E7%BD%91%E5%9D%80%E8%A7%84%E5%88%99"><span class="toc-number">7.</span> <span class="toc-text">3.分析数据源网址规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%86%E6%9E%90%E9%A1%B5%E9%9D%A2%E8%A7%84%E5%88%99"><span class="toc-number">8.</span> <span class="toc-text">4.分析页面规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8B%98%E8%AF%AF%E8%A1%A8"><span class="toc-number">9.</span> <span class="toc-text">勘误表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%88%AC%E8%99%AB"><span class="toc-number">10.</span> <span class="toc-text">5.爬虫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1%E7%A1%AE%E8%AE%A4%E8%A6%81%E8%A2%AB%E7%88%AC%E5%8F%96%E7%9A%84%E7%BD%91%E9%A1%B5%E7%BD%91%E5%9D%80"><span class="toc-number">10.1.</span> <span class="toc-text">5.1确认要被爬取的网页网址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%88%AC%E8%99%AB%E9%83%A8%E5%88%86"><span class="toc-number">10.2.</span> <span class="toc-text">5.2 爬虫部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E5%8C%B9%E9%85%8D%E5%8F%96%E5%87%BA%E9%83%A8%E5%88%86"><span class="toc-number">10.3.</span> <span class="toc-text">5.3 网页内容匹配取出部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4%E5%86%99%E5%85%A5csv%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">10.4.</span> <span class="toc-text">5.4写入csv文件格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6%E5%B0%81%E8%A3%85%E6%88%90%E7%B1%BB"><span class="toc-number">10.5.</span> <span class="toc-text">5.6封装成类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">11.</span> <span class="toc-text">6.数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%BB%BA%E7%AB%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.</span> <span class="toc-text">7.建立模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1%E5%87%86%E5%A4%87"><span class="toc-number">12.1.</span> <span class="toc-text">7.1准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-1-%E5%BC%95%E5%85%A5%E6%89%80%E9%9C%80%E8%A6%81%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-number">12.1.1.</span> <span class="toc-text">7.1.1 引入所需要的头文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-%E9%80%89%E6%8B%A9%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.1.2.</span> <span class="toc-text">7.1.2 选择模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-3-%E9%80%89%E6%8B%A9%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95"><span class="toc-number">12.1.3.</span> <span class="toc-text">7.1.3 选择评估方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-4-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">12.1.4.</span> <span class="toc-text">7.1.4 获取数据集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2%E5%BB%BA%E7%AB%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.2.</span> <span class="toc-text">7.2建立模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E8%8E%B7%E5%8F%96%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C"><span class="toc-number">12.3.</span> <span class="toc-text">7.3 获取模型评估结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E7%94%A8joblib%E6%A8%A1%E5%9D%97%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B"><span class="toc-number">12.4.</span> <span class="toc-text">7.4 用joblib模块保存模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-%E5%B0%81%E8%A3%85"><span class="toc-number">12.5.</span> <span class="toc-text">7.5 封装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E6%80%BB%E6%8E%A7"><span class="toc-number">13.</span> <span class="toc-text">8 总控</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BB%A3%E7%A0%81"><span class="toc-number">13.1.</span> <span class="toc-text">8.1 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">13.2.</span> <span class="toc-text">8.2 使用方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%9C%80%E5%90%8E%E6%95%88%E6%9E%9C"><span class="toc-number">14.</span> <span class="toc-text">9 最后效果</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.facebook.com/sharer.php?u=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://twitter.com/share?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&text=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.linkedin.com/shareArticle?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://pinterest.com/pin/create/bookmarklet/?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&is_video=false&description=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=用python+sklearn(机器学习)实现天气预测&body=Check out this article: https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/" rel="external nofollow noreferrer"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://getpocket.com/save?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://reddit.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.stumbleupon.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://digg.com/submit?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&title=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.tumblr.com/share/link?url=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&name=用python+sklearn(机器学习)实现天气预测&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener external nofollow noreferrer" href="https://news.ycombinator.com/submitlink?u=https://eritque-arcus.tech/2020/12/13/%E7%94%A8python-sklearn-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-%E5%AE%9E%E7%8E%B0%E5%A4%A9%E6%B0%94%E9%A2%84%E6%8A%A5/&t=用python+sklearn(机器学习)实现天气预测"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2024
    Eritque arcus
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener external nofollow noreferrer" href="http://github.com/Nambers">Projects</a></li><!--
     --><!--
       --><li><a href="/files/">Files</a></li><!--
     --><!--
       --><li><a href="/ctf-cheatsheet/">CTF-cheatsheet</a></li><!--
     --><!--
       --><li><a href="/link/">Links</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html">Travelling</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
