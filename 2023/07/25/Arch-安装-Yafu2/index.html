<!DOCTYPE html><html lang="en" color-mode="light"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="Eritque arcus"><meta name="description" content="Eritque arcus&#39;s blog"><title>Arch Yafu2 安装指南 | Eritque arcus&#39;s blog</title><link rel="apple-touch-icon" href="/images/avatar.png"><link rel="icon" href="/images/avatar.png"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><script defer type="text/javascript" src="/plugins/jquery.min.js"></script><link href="/plugins/jquery.fancybox.min.css" rel="stylesheet"><script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script><script src="/js/fancybox.js"></script><script>var html=document.documentElement;const colorMode=localStorage.getItem("color-mode");colorMode&&document.documentElement.setAttribute("color-mode",colorMode)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="app"><div class="header"><div class="avatar"><a href="/"><img src="/images/avatar.png" alt=""></a><div class="nickname"><a href="/">Eritque arcus</a></div></div><div class="navbar"><ul><li class="nav-item" data-path="/archives/"><a href="/archives/">Archives</a></li><li class="nav-item" data-path="/categories/"><a href="/categories/">Categories</a></li><li class="nav-item" data-path="/tags/"><a href="/tags/">Tags</a></li><li class="nav-item" data-path="/link/"><a href="/link/">Friends</a></li><li class="nav-item" data-path="/about/"><a href="/about/">About</a></li><li class="nav-item" data-path="/ctf-cheatsheet/"><a href="/ctf-cheatsheet/">CTF-cheatsheet</a></li><li class="nav-item" data-path="https://photos.ikuyo.dev"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://photos.ikuyo.dev">Photos</a></li><li class="nav-item" data-path="https://www.travellings.cn/go.html"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html">开往</a></li></ul></div></div><script src="/js/activeNav.js"></script><div class="flex-container"><script async type="text/javascript" src="/plugins/clipboard.min.js"></script><script src="/js/codeCopy.js"></script><div class="container post-details" id="post-details"><div class="post-content"><h1 class="post-title">Arch Yafu2 安装指南</h1><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime mr-10" title="Update time"></i> 2025-02-27 17:24:29 </span><span class="post-categories"><i class="iconfont icon-bookmark" title="Categories"></i> <span class="span--category"><a href="/categories/How-to/" title="How-to"><b>#</b> How-to </a></span></span><span class="post-tags"><i class="iconfont icon-tags mr-10" title="Tags"></i> <span class="span--tag mr-8"><a href="/tags/Arch/" title="Arch">#Arch </a></span><span class="span--tag mr-8"><a href="/tags/yafu2/" title="yafu2">#yafu2</a></span></span></div><div class="markdown-body"><blockquote><p>YAFU is the result of an ongoing hobby project to understand how to factor<br>large integers, and how to factor them fast.</p></blockquote><p><strong>参考:</strong> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.mersenneforum.org/showthread.php?p=634890">How I install YAFU version 2 onto my Ubuntu Machines by EdH</a><br><strong>Yafu2 官方 thread:</strong> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.mersenneforum.org/showthread.php?t=26681">YAFU 2.0</a></p><h2 id="0-前置依赖"><a href="#0-前置依赖" class="headerlink" title="0. 前置依赖"></a>0. 前置依赖</h2><p>先准备一个空文件夹, 为了方便依赖和yafu2本体装在一个文件夹下</p><h3 id="0-1-GMP"><a href="#0-1-GMP" class="headerlink" title="0.1 GMP"></a>0.1 GMP</h3><ol><li>找到 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://gmplib.org/download/gmp">https://gmplib.org/download/gmp</a> 下最新版本并下载(比如我现在是 <code>v6.2.1</code>)</li><li>解压改名</li><li><code>./configure</code>和<code>make</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget https://gmplib.org/download/gmp/gmp-6.2.1.tar.bz2</span><br><span class="line">tar jxvf gmp-6.2.1.tar.bz2</span><br><span class="line"><span class="built_in">mv</span> gmp-6.2.1 gmp</span><br><span class="line"><span class="built_in">cd</span> gmp</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br><span class="line">make check</span><br></pre></td></tr></table></figure><h3 id="0-2-GMP-ECM"><a href="#0-2-GMP-ECM" class="headerlink" title="0.2 GMP-ECM"></a>0.2 GMP-ECM</h3><ol><li>找到 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://gitlab.inria.fr/zimmerma/ecm/-/releases">https://gitlab.inria.fr/zimmerma/ecm/-/releases</a> 的最新 release (现在是 <code>v7.0.5</code>) 然后复制他的下载链接(<code>ecm-x.y.z.tar.gz</code>)并下载</li><li>解压改名</li><li><code>configure</code> 和 <code>make</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wget https://gitlab.inria.fr/zimmerma/ecm/uploads/89f6f0d65d3e980cef33dc922004e4b2/ecm-7.0.5.tar.gz</span><br><span class="line">tar zxvf ecm-7.0.5.tar.gz</span><br><span class="line"><span class="built_in">mv</span> ecm-7.0.5 gmp-ecm</span><br><span class="line"><span class="built_in">cd</span> gmp-ecm</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br><span class="line">make check</span><br></pre></td></tr></table></figure><h3 id="0-3-msieve"><a href="#0-3-msieve" class="headerlink" title="0.3 msieve"></a>0.3 msieve</h3><ol><li>找到 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://sourceforge.net/projects/msieve/files/msieve">https://sourceforge.net/projects/msieve/files/msieve</a> 的最新版本 (现在是 <code>v1.53</code>) 然后下载源码 (<code>msievexyz_src.tar.gz</code>或者<code>msievexyz.tar.gz</code>)</li><li>解压改名和<code>make</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://sourceforge.net/projects/msieve/files/msieve/Msieve%20v1.53/msieve153_src.tar.gz/download</span><br><span class="line">tar zxvf download</span><br><span class="line"><span class="built_in">mv</span> msieve-1.53 msieve</span><br><span class="line"><span class="built_in">cd</span> msieve</span><br><span class="line">make all</span><br></pre></td></tr></table></figure><h3 id="0-4-ytools"><a href="#0-4-ytools" class="headerlink" title="0.4 ytools"></a>0.4 ytools</h3><ol><li>git clone</li><li>改 Makefile:<br><code>CC = gcc-7.3.0</code> &#x3D;&gt; <code>CC = gcc</code></li><li><code>make</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:bbuhrow/ytools.git <span class="comment"># or git clone https://github.com/bbuhrow/ytools</span></span><br><span class="line"><span class="built_in">cd</span> ytools</span><br><span class="line">vim Makefile</span><br><span class="line">make</span><br></pre></td></tr></table></figure><h3 id="0-5-ysieve"><a href="#0-5-ysieve" class="headerlink" title="0.5 ysieve"></a>0.5 ysieve</h3><ol><li>git clone</li><li><code>make</code></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:bbuhrow/ysieve.git <span class="comment"># or git clone https://github.com/bbuhrow/ysieve</span></span><br><span class="line"><span class="built_in">cd</span> ysieve</span><br><span class="line">make</span><br></pre></td></tr></table></figure><h2 id="1-安装-Yafu2"><a href="#1-安装-Yafu2" class="headerlink" title="1. 安装 Yafu2"></a>1. 安装 Yafu2</h2><ol><li>git clone <code>git clone git@github.com:bbuhrow/yafu.git</code></li><li>修改 Makefile:<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INC += -I../gmp_install/gmp-6.2.0/<span class="keyword">include</span></span><br><span class="line">LIBS += -L../gmp_install/gmp-6.2.0/lib</span><br><span class="line"></span><br><span class="line">INC += -I../ecm_install/<span class="keyword">include</span>/</span><br><span class="line">LIBS += -L../ecm_install/lib/</span><br></pre></td></tr></table></figure>to<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">INC += -I/usr/local/<span class="keyword">include</span>/</span><br><span class="line">LIBS += -L/usr/local/<span class="keyword">include</span>/</span><br><span class="line"></span><br><span class="line"><span class="comment">#INC += -I../ecm_install/include/</span></span><br><span class="line"><span class="comment">#LIBS += -L../ecm_install/lib/</span></span><br></pre></td></tr></table></figure></li><li>执行 <code>lscpu</code> 主要看核数和那些 cpu flag</li><li>修改 <code>yafu.ini</code><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">% <span class="attr">threads</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">ggnfs_dir</span>=..\..\ggnfs-bin\x64\</span><br><span class="line"><span class="attr">ecm_path</span>=..\..\gmp-ecm\bin\mingw\ecm.exe</span><br></pre></td></tr></table></figure>to<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">threads</span>=&lt;<span class="comment"># CPU 数量&gt;</span></span><br><span class="line"><span class="attr">ggnfs_dir</span>=../ggnfs/bin/</span><br><span class="line"><span class="attr">ecm_path</span>=/usr/local/bin/ecm</span><br></pre></td></tr></table></figure>这里 <code>ggnfs_dir</code> 没装也没问题</li><li>[可选] 可以在下一步的 make 命令加上那些 CPU flag, 比如 <code>make NFS=1 USE_SSE41=1 USEAVX2=1</code>, 不过这也可能导致问题, 我电脑上就只能编 <code>NFS=1</code></li><li><code>make NFS=1</code></li></ol><h2 id="2-Troubleshooting"><a href="#2-Troubleshooting" class="headerlink" title="2 Troubleshooting"></a>2 Troubleshooting</h2><h3 id="2-1-SIQS-c-2448-undefined-reference-to-nextRoots-32k-avx2-intrin"><a href="#2-1-SIQS-c-2448-undefined-reference-to-nextRoots-32k-avx2-intrin" class="headerlink" title="2.1 SIQS.c:2448: undefined reference to &#39;nextRoots_32k_avx2_intrin&#39;"></a>2.1 <code>SIQS.c:2448: undefined reference to &#39;nextRoots_32k_avx2_intrin&#39;</code></h3><p>因为没有清理之前不同 flag 编译结果导致的, 在下一次 <code>make</code> 前执行 <code>make clean</code> + 那些 flag 就行</p><h3 id="2-2-msieve-找不到-gzlib-function"><a href="#2-2-msieve-找不到-gzlib-function" class="headerlink" title="2.2 msieve 找不到 gzlib function"></a>2.2 msieve 找不到 gzlib function</h3><p>具体日志如下:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_open&#x27;:</span><br><span class="line">savefile.c:(.text+0x132): undefined reference to `gzopen64&#x27;</span><br><span class="line">/usr/bin/ld: savefile.c:(.text+0x23e): undefined reference to `gzopen64&#x27;</span><br><span class="line">/usr/bin/ld: savefile.c:(.text+0x269): undefined reference to `gzopen64&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_close&#x27;:</span><br><span class="line">savefile.c:(.text+0x311): undefined reference to `gzclose&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_write_line&#x27;:</span><br><span class="line">savefile.c:(.text+0x3f9): undefined reference to `gzputs&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_flush&#x27;:</span><br><span class="line">savefile.c:(.text+0x46c): undefined reference to `gzputs&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_eof&#x27;:</span><br><span class="line">savefile.c:(.text+0x339): undefined reference to `gzeof&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_read_line&#x27;:</span><br><span class="line">savefile.c:(.text+0x39c): undefined reference to `gzgets&#x27;</span><br><span class="line">/usr/bin/ld: ../msieve//libmsieve.a(savefile.o): in function `savefile_rewind&#x27;:</span><br><span class="line">savefile.c:(.text+0x499): undefined reference to `gzrewind&#x27;</span><br></pre></td></tr></table></figure><p>在 yafu 的 Makefile 里面加上 <code>LIBS+= -lc -lz</code></p></div><div class="prev-or-next"><div class="post-foot-next"><a href="/2023/02/10/emacs-configuration/" target="_self"><i class="iconfont icon-chevronleft"></i> <span>Prev</span></a></div><div class="post-attach"><span class="post-pubtime"><i class="iconfont icon-updatetime mr-10" title="Update time"></i> 2025-02-27 17:24:29 </span><span class="post-categories"><i class="iconfont icon-bookmark" title="Categories"></i> <span class="span--category"><a href="/categories/How-to/" title="How-to"><b>#</b> How-to </a></span></span><span class="post-tags"><i class="iconfont icon-tags mr-10" title="Tags"></i> <span class="span--tag mr-8"><a href="/tags/Arch/" title="Arch">#Arch </a></span><span class="span--tag mr-8"><a href="/tags/yafu2/" title="yafu2">#yafu2</a></span></span></div><div class="post-foot-prev"><a href="/2023/09/01/john-the-ripper-%E8%A7%A3%E5%AF%86-salted-SHA512/" target="_self"><span>Next</span> <i class="iconfont icon-chevronright"></i></a></div></div></div><div id="btn-catalog" class="btn-catalog"><i class="iconfont icon-catalog"></i></div><div class="post-catalog hidden" id="catalog"><div class="title">Contents</div><div class="catalog-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-%E5%89%8D%E7%BD%AE%E4%BE%9D%E8%B5%96"><span class="toc-text">0. 前置依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-1-GMP"><span class="toc-text">0.1 GMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-2-GMP-ECM"><span class="toc-text">0.2 GMP-ECM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-3-msieve"><span class="toc-text">0.3 msieve</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-4-ytools"><span class="toc-text">0.4 ytools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0-5-ysieve"><span class="toc-text">0.5 ysieve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85-Yafu2"><span class="toc-text">1. 安装 Yafu2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Troubleshooting"><span class="toc-text">2 Troubleshooting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-SIQS-c-2448-undefined-reference-to-nextRoots-32k-avx2-intrin"><span class="toc-text">2.1 SIQS.c:2448: undefined reference to &#39;nextRoots_32k_avx2_intrin&#39;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-msieve-%E6%89%BE%E4%B8%8D%E5%88%B0-gzlib-function"><span class="toc-text">2.2 msieve 找不到 gzlib function</span></a></li></ol></li></ol></div></div><script src="/js/catalog.js"></script></div><div class="footer"><div class="social"><ul><li><a title="github" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Nambers"><i class="fa-brands fa-github fa-lg"></i></a></li><li><a title="email" href="mailto:eritque-arcus@ikuyo.dev"><i class="fa-solid fa-envelope fa-lg"></i></a></li></ul></div><div class="footer-more"><a href="https://github.com/Nambers" rel="external nofollow noreferrer" target="_blank">Copyright ©2020-2025 Eritque Arcus</a></div><div class="footer-more"><a href="https://github.com/zchengsite/hexo-theme-oranges" rel="external nofollow noreferrer" target="_blank">Theme by Oranges | Powered by Hexo</a></div><div class="footer-more"><a href="https://icp.gov.moe/?keyword=20222242" target="_blank"><img src="/moe-icon120.png" style="width:1.5em;vertical-align:bottom"> 萌ICP备20222242号</a></div><script defer src="https://4-um4m1.ikuyo.dev/script.js" data-website-id="34e0a647-a8e8-40a8-ad62-742e9d604413"></script></div></div><div class="tools-bar"><div class="back-to-top tools-bar-item hidden"><a href="javascript: void(0)" rel="external nofollow noreferrer"><i class="iconfont icon-chevronup"></i></a></div><script src="/js/backtotop.js"></script><div class="tools-bar-item theme-icon" id="switch-color-scheme"><a href="javascript: void(0)" rel="external nofollow noreferrer"><i id="theme-icon" class="iconfont icon-moon"></i></a></div><script src="/js/colorscheme.js"></script></div></div></body></html>